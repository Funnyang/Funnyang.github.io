<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.55.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>DNS 隧道免费上网教程之 iodined | 小 ceng 的时间日志</title>
    <meta property="og:title" content="DNS 隧道免费上网教程之 iodined - 小 ceng 的时间日志">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content="2015-03-03T20:01:57&#43;08:00">
        
        
    <meta property="article:modified_time" content="2015-03-03T20:01:57&#43;08:00">
        
    <meta name="Keywords" content="">
    <meta name="description" content="DNS 隧道免费上网教程之 iodined">
        
    <meta name="author" content="lon3r">
    <meta property="og:url" content="https://tlog.cc/posts/old_blog/dns%E9%9A%A7%E9%81%93%E5%85%8D%E8%B4%B9%E4%B8%8A%E7%BD%91%E6%95%99%E7%A8%8B%E4%B9%8Biodined/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="/css/normalize.css">
    
        <link rel="stylesheet" href="/css/prism.css">
    
    <link rel="stylesheet" href="/css/style.css">
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    


    
    
</head>

<body>
<header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://tlog.cc/">
                        小 ceng 的时间日志
                    </a>
                
                <p class="description">一条狗</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://tlog.cc/">首页</a>
                    
                    <a  href="https://tlog.cc/archives/" title="归档">归档</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>


<div id="body">
    <div class="container">
        <div class="col-group">

            <div class="col-8" id="main">
                <div class="res-cons">
                    <article class="post">
                        <header>
                            <h1 class="post-title">DNS 隧道免费上网教程之 iodined</h1>
                        </header>
                        <date class="post-meta meta-date">
                            2015年3月3日
                        </date>
                        
                        <div class="post-meta">
                            <span>|</span>
                            
                                <span class="meta-category"><a href="https://tlog.cc/categories/%E6%9D%82%E9%A1%B9">杂项</a></span>
                            
                        </div>
                        
                        
                        <div class="post-meta">
                            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span> 阅读</span></span>
                        </div>
                        
                        <div class="post-content">
                            <blockquote>
<p>旧博客迁移文章，内容可能已失去价值，仅为留念，做了简单重新排版，勉强可看。</p>
</blockquote>

<p>实现免费上网一直是鄙人的终极奋斗目标</p>

<p>近日，在下听说了一种可以通过建立 DNS 隧道免费上网的方式，当然这项技术其实早就有了，只是本人见识短，目光浅，如今才真正知晓。</p>

<h2 id="背景">背景</h2>

<p>CMCC、ChinaNet等公共热点一般设置了访问控制，阻止了网络访问，但是对于DNS查询没有限制。因此可以利用DNS查询跟外界服务器沟通，绕过账号认证。</p>

<h2 id="原理">原理</h2>

<p>在 Internet 中运行一台假的 DNS 服务器，通过 DNS 查询实现被限制访问 Internet 的主机与该服务器的通讯。（本人的理解很粗浅）</p>

<h2 id="实操">实操</h2>

<h3 id="前提条件">前提条件</h3>

<ol>
<li>拥有一个具有控制权的域名</li>
<li>一台 运行于公网的服务器</li>
</ol>

<h3 id="准备工作">准备工作：</h3>

<ol>
<li>下载 iodine 安装包 <a href="http://code.kryo.se/iodine/">http://code.kryo.se/iodine/</a></li>
<li>下载 openvpn window 版</li>
</ol>

<p>本次搭建环境为 64 位 CentOS6.5 服务端和 Windows8 客户端</p>

<h3 id="搭建步骤">搭建步骤</h3>

<h4 id="服务端搭建">服务端搭建</h4>

<h5 id="1-安装iodine">1. 安装iodine</h5>

<pre><code class="language-bash"> tar -zxvf iodine-0.7.0.tar.gz  
 cd iodine-0.7.0  
 make &amp; make install
</code></pre>

<h5 id="2-设置域名的dns-假设你的域名为-test-com-你的服务器为-192-168-1-10">2. 设置域名的DNS 假设你的域名为 <code>test.com</code>，你的服务器为<code>192.168.1.10</code></h5>

<p>如果你对DNS服务器具有控制权（一般没有），你可以直接在DNS服务器添加一条NS记录，使<code>iodined.test.com</code> 由 <code>192.168.1.10</code> 来解析</p>

<p>如果你对 DNS 服务器没有控制权，那么也很简单，可以添加一条A记录和一条NS记录</p>

<p>A记录：<code>iodine.test.com</code> <code>192.168.1.10</code></p>

<p>NS记录： <code>iodined.test.com</code> <code>iodine.test.com</code></p>

<p>~~以下是以万网为例的截图 ~~</p>

<h5 id="3-运行iodined">3. 运行iodined</h5>

<pre><code class="language-bash">iodined -f -c -P 密码 10.0.0.1 iodined.test.com
</code></pre>

<p>注意P要大写，后面接要设置的密码，10.0.0.1是设置的DNS隧道的ip网段，可以改为其它网段，运行成功之后，如下：</p>

<pre><code>Opened dns0  
Setting IP of dns0 to 10.0.0.1  
Setting MTU of dns0 to 1130  
Opened IPv4 UDP socket  
istening to dns for domain iodined.test.com
</code></pre>

<h4 id="客户端搭建">客户端搭建</h4>

<h5 id="1-安装tap-virtual-ethernet-adapter虚拟网卡驱动">1. 安装TAP Virtual Ethernet Adapter虚拟网卡驱动</h5>

<p>下载的 openvpn 不需要最新版，本人下载最新版之后测试不成功。</p>

<p>其实我们只是需要安装它的 TAP Virtual Ethernet Adapter 模块，安装时可以只勾选该模块，这里我使用的是 6kuaibo 里的虚拟网卡模块。</p>

<h5 id="2-客户端的-iodine-基本不用安装-解压即可">2. 客户端的 iodine 基本不用安装，解压即可。</h5>

<p>以管理员身份运行cmd，cd到iodine目录，执行以下命令</p>

<pre><code class="language-bash">iodine -f -r -P 密码 192.168.1.10 iodined.test.com
</code></pre>

<p>注意服务端运行的是 iodined，而客户端运行的是 iodine。运行结果如下：</p>

<pre><code>Opening device 本地连接 3  
Opened IPv4 UDP socket  
Opened IPv4 UDP socket  
Opened IPv4 UDP socket  
Sending DNS queries for iodined.test.com to 192.168.1.10  
Autodetecting DNS query type (use -T to override).  
Using DNS type NULL queriesRetrying version check…  
Retrying version check…  
Version ok, both using protocol v 0x00000502. You are user #2  
Enabling interface ‘本地连接 3′  
Setting IP of interface ‘本地连接 3′ to 10.0.0.2 (can take a few seconds)…

Server tunnel IP is 10.0.0.1  
Skipping raw mode  
Using EDNS0 extension  
Retrying upstream codec test…  
Switching upstream to codec Base128  
Server switched upstream to codec Base128  
No alternative downstream codec available, using default (Raw)  
Switching to lazy mode for low-latency  
Server switched to lazy mode  
Autoprobing max downstream fragment size… (skip with -m fragsize)  
768 ok.. 1152 ok.. …1344 not ok.. …1248 not ok.. …1200 not ok.. 1176 ok..  
1188 ok.. will use 1188-2=1186  
Setting downstream fragment size to max 1186…  
Connection setup complete, transmitting data.
</code></pre>

<p>现在 ping <code>10.0.0.1</code> 如果能 ping 通，就大功告成了！</p>

<p>最后在服务器里搭建一个代理，就可以通过 DNS 隧道上网了。</p>

<p>至于 Android 端，需要有 root 权限，执行的命令和 Windows 是一样的。</p>

<p>注意：设置代理的时候要把“终端模拟器”排除在外，比如我使用的是 shadowsocks，不能使用全局代理，要在使用分应用代理，开启绕行模式，并勾选终端模拟器。</p>

<p> </p>
                        </div>

                        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://tlog.cc/">lon3r</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://tlog.cc/posts/old_blog/dns%E9%9A%A7%E9%81%93%E5%85%8D%E8%B4%B9%E4%B8%8A%E7%BD%91%E6%95%99%E7%A8%8B%E4%B9%8Biodined/">https://tlog.cc/posts/old_blog/dns%E9%9A%A7%E9%81%93%E5%85%8D%E8%B4%B9%E4%B8%8A%E7%BD%91%E6%95%99%E7%A8%8B%E4%B9%8Biodined/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



                        


                        <div class="post-meta meta-tags">
                            
                            <ul class="clearfix">
                                
                                <li><a href="https://tlog.cc/tags/dns">DNS</a></li>
                                
                                <li><a href="https://tlog.cc/tags/iodined">iodined</a></li>
                                
                            </ul>
                            
                        </div>
                    </article>
                    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tlog-1" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
                </div>
            </div>
            <div id="secondary">
    <section class="widget">
        <form id="search" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://tlog.cc/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://tlog.cc/posts/vuejs/%E5%B0%9D%E8%AF%95%E5%9C%A8-vue-%E6%8C%87%E4%BB%A4%E4%B8%AD%E9%98%BB%E6%AD%A2%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91/" title="尝试在 vue 指令中阻止事件触发">尝试在 vue 指令中阻止事件触发</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/macos/%E5%A6%82%E4%BD%95%E5%B0%86-timemachine-%E5%A4%87%E4%BB%BD%E4%BB%8E%E7%A7%BB%E5%8A%A8%E7%A1%AC%E7%9B%98%E8%BF%81%E7%A7%BB%E5%88%B0%E7%BD%91%E7%BB%9C%E9%A9%B1%E5%8A%A8%E5%99%A8/" title="如何将 TimeMachine 备份数据从移动硬盘迁移到网络驱动器">如何将 TimeMachine 备份数据从移动硬盘迁移到网络驱动器</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/hei/hack-synology-note/" title="黑群晖笔记">黑群晖笔记</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/journal/2019-05-02/" title="假期随感">假期随感</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/golang/iris-learning-notes-1/" title="Iris 学习笔记 1">Iris 学习笔记 1</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/old_blog/debian-vsftpd%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" title="debian vsftpd安装配置">debian vsftpd安装配置</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/old_blog/%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85chkrootkit%E6%8A%A5%E9%94%99/" title="源码安装 chkrootkit 报错">源码安装 chkrootkit 报错</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/old_blog/%E9%BB%91%E8%8B%B9%E6%9E%9C%E7%9B%B4%E5%8D%87macos-sierra/" title="黑苹果直升 macOS Sierra">黑苹果直升 macOS Sierra</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/old_blog/beginners-guide-of-nginx/" title="Beginner’s Guide of Nginx">Beginner’s Guide of Nginx</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/posts/old_blog/y480-%E5%AE%8C%E7%BE%8E%E9%BB%91%E8%8B%B9%E6%9E%9C%E5%85%A8%E5%A5%97%E9%A9%B1%E5%8A%A8%E5%88%86%E4%BA%AB/" title="Y480 完美黑苹果全套驱动分享">Y480 完美黑苹果全套驱动分享</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">福利派送</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://www.vultr.com/?ref=6964447" title="走个 Vultr VPS 推广" target="_blank" style="color:red">
                
                    <img src="https://www.vultr.com/media/banner_1.png">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://tlog.cc/categories/golang/">golang(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/macos/">macos(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E5%89%8D%E7%AB%AF/">前端(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E6%84%9F%E6%83%B3/">感想(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E6%97%A5%E5%BF%97/">日志(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E6%9D%82%E9%A1%B9/">杂项(4)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/">路由器(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E9%BB%91/">黑(1)</a>
    </li>
    
    <li>
        <a href="https://tlog.cc/categories/%E9%BB%91%E8%8B%B9%E6%9E%9C/">黑苹果(1)</a>
    </li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
    <a href="https://tlog.cc/tags/apache/">apache</a>
    
    <a href="https://tlog.cc/tags/dns/">dns</a>
    
    <a href="https://tlog.cc/tags/go/">go</a>
    
    <a href="https://tlog.cc/tags/golang/">golang</a>
    
    <a href="https://tlog.cc/tags/hackintosh/">hackintosh</a>
    
    <a href="https://tlog.cc/tags/iodined/">iodined</a>
    
    <a href="https://tlog.cc/tags/iris/">iris</a>
    
    <a href="https://tlog.cc/tags/macos/">macos</a>
    
    <a href="https://tlog.cc/tags/mysql/">mysql</a>
    
    <a href="https://tlog.cc/tags/osx/">osx</a>
    
    <a href="https://tlog.cc/tags/php/">php</a>
    
    <a href="https://tlog.cc/tags/synology/">synology</a>
    
    <a href="https://tlog.cc/tags/timemachine/">timemachine</a>
    
    <a href="https://tlog.cc/tags/vuejs/">vuejs</a>
    
    <a href="https://tlog.cc/tags/xhprof/">xhprof</a>
    
    <a href="https://tlog.cc/tags/xpenology/">xpenology</a>
    
    <a href="https://tlog.cc/tags/%E6%84%9F%E6%83%B3/">感想</a>
    
    <a href="https://tlog.cc/tags/%E8%81%94%E9%80%9A201/">联通201</a>
    
    <a href="https://tlog.cc/tags/%E8%9C%97%E7%89%9B%E6%98%9F%E9%99%85/">蜗牛星际</a>
    
    <a href="https://tlog.cc/tags/%E9%BB%91%E7%BE%A4%E6%99%96/">黑群晖</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://tlog.cc/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
        </div>
    </div>
</div>
<footer id="footer">
    <div class="container">
        &copy; 2019 <a href="https://tlog.cc/">小 ceng 的时间日志 By lon3r</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/rujews/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    <script type="text/javascript">
    
    (function(){
        $("pre code").parent().addClass("line-numbers")
    }())

    window.MathJax = {
        tex2jax: {
            inlineMath: [ ['$','$'] ],
            processEscapes: true
        }
    };
    </script>
    <script type="text/javascript" src="/js/prism.js" async="true"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src="/js/totop.js?v=0.0.0" async=""></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-139549186-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



<script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




</body>
</html>
